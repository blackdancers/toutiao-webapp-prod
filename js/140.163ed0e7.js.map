{"version":3,"file":"js/140.163ed0e7.js","mappings":"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","sources":["webpack://toutiao-webapp/./src/views/search/index.vue","webpack://toutiao-webapp/./src/components/Search/SearchSuggestion.vue","webpack://toutiao-webapp/src/components/Search/SearchSuggestion.vue","webpack://toutiao-webapp/./src/components/Search/SearchSuggestion.vue?2345","webpack://toutiao-webapp/./src/components/Search/SearchSuggestion.vue?e18c","webpack://toutiao-webapp/./src/components/Search/SearchResult.vue","webpack://toutiao-webapp/src/components/Search/SearchResult.vue","webpack://toutiao-webapp/./src/components/Search/SearchResult.vue?282f","webpack://toutiao-webapp/./src/components/Search/SearchResult.vue?6a95","webpack://toutiao-webapp/./src/components/Search/SearchHistory.vue","webpack://toutiao-webapp/src/components/Search/SearchHistory.vue","webpack://toutiao-webapp/./src/components/Search/SearchHistory.vue?c2fc","webpack://toutiao-webapp/./src/components/Search/SearchHistory.vue?7c29","webpack://toutiao-webapp/src/views/search/index.vue","webpack://toutiao-webapp/./src/views/search/index.vue?e0e8","webpack://toutiao-webapp/./src/views/search/index.vue?7f48","webpack://toutiao-webapp/./src/api/user.js","webpack://toutiao-webapp/./src/api/article.js","webpack://toutiao-webapp/./src/api/channel.js","webpack://toutiao-webapp/./src/api/home.js","webpack://toutiao-webapp/./src/api/comment.js","webpack://toutiao-webapp/./src/api/index.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-container\"},[_c('form',{attrs:{\"action\":\"/\"}},[_c('van-search',{attrs:{\"placeholder\":\"请输入搜索关键词\",\"background\":\"#3296FA\",\"show-action\":\"\"},on:{\"search\":_vm.onSearch,\"cancel\":_vm.onCancel,\"focus\":function($event){_vm.isResultShow = false}},model:{value:(_vm.keyword),callback:function ($$v) {_vm.keyword=$$v},expression:\"keyword\"}})],1),(_vm.isResultShow)?_c('SearchResult',{attrs:{\"keyword\":_vm.keyword}}):(_vm.keyword)?_c('SearchSuggestion',{attrs:{\"keyword\":_vm.keyword},on:{\"search\":_vm.onSearch}}):_c('SearchHistory',{attrs:{\"searchHistory\":_vm.searchHistory},on:{\"search\":_vm.onSearch,\"delSearchHistoryItem\":_vm.delSearchHistoryItem,\"clearAllSearchHistory\":function($event){_vm.searchHistory = []}}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-suggestion\"},_vm._l((_vm.suggestions),function(item,index){return _c('van-cell',{key:index,attrs:{\"icon\":\"search\"},on:{\"click\":function($event){return _vm.$emit('search', item)}},scopedSlots:_vm._u([{key:\"title\",fn:function(){return [_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.highlight(item))}})]},proxy:true}],null,true)})}),1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"search-suggestion\">\r\n    <van-cell v-for=\"(item, index) in suggestions\" :key=\"index\" icon=\"search\" @click=\"$emit('search', item)\">\r\n      <!-- 高亮显示搜索内容 -->\r\n      <template #title>\r\n        <!-- <span v-html=\"item\"></span> -->\r\n        <span v-html=\"highlight(item)\"></span>\r\n      </template>\r\n    </van-cell>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getSearchSuggestionsAPI } from '@/api/index'\r\nimport { debounce } from 'lodash'\r\nexport default {\r\n  name: 'SearchSuggestion',\r\n  props: {\r\n    keyword: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  watch: {\r\n    keyword: {\r\n      // 监视的处理函数，防抖优化 debounce\r\n      // `debounce`中的回调函数必须是function不可以是箭头函数\r\n\r\n      // handler: this.$_.debounce(function (value) {\r\n      //   this.loadSearchSuggestions(value)\r\n      // }, 200),\r\n      handler: debounce(function (value) {\r\n        this.loadSearchSuggestions(value)\r\n      }, 200),\r\n\r\n      // 首次监视触发\r\n      immediate: true\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      suggestions: [] // 搜索建议内容\r\n    }\r\n  },\r\n  methods: {\r\n    async loadSearchSuggestions (value) {\r\n      try {\r\n        const { data: res } = await getSearchSuggestionsAPI(value)\r\n        // 搜索返回空值处理:把搜索内容赋值给搜索建议内容\r\n        if (res.data.options && res.data.options[0] == null) {\r\n          // res.data.options[0] = this.keyword\r\n          this.suggestions = [this.keyword]\r\n        } else {\r\n          this.suggestions = res.data.options\r\n        }\r\n      } catch {\r\n        this.$toast('获取失败')\r\n      }\r\n    },\r\n    // 高亮显示方法\r\n    highlight (text) {\r\n      const highlightStr = `<span class=\"active\">${this.keyword}</span>`\r\n      return text.split(this.keyword).join(highlightStr)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.search-suggestion {\r\n  :deep(span.active) {\r\n    color: #3296fa;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SearchSuggestion.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SearchSuggestion.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SearchSuggestion.vue?vue&type=template&id=0be7680c&scoped=true&\"\nimport script from \"./SearchSuggestion.vue?vue&type=script&lang=js&\"\nexport * from \"./SearchSuggestion.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SearchSuggestion.vue?vue&type=style&index=0&id=0be7680c&prod&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0be7680c\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-result\"},[_c('van-list',{attrs:{\"finished\":_vm.finished,\"error\":_vm.error,\"error-text\":\"请求失败，点击重新加载\",\"finished-text\":\"没有更多了\"},on:{\"update:error\":function($event){_vm.error=$event},\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.list),function(item){return _c('van-cell',{key:item.art_id,attrs:{\"title\":item.title}})}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"search-result\">\r\n    <van-list v-model=\"loading\" :finished=\"finished\" :error.sync=\"error\" error-text=\"请求失败，点击重新加载\" finished-text=\"没有更多了\"\r\n      @load=\"onLoad\">\r\n      <van-cell v-for=\"item in list\" :key=\"item.art_id\" :title=\"item.title\" />\r\n    </van-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getSearchResultAPI } from '@/api/index'\r\nexport default {\r\n  name: 'SearchResult',\r\n  props: {\r\n    keyword: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      error: false,\r\n      list: [],\r\n      loading: false,\r\n      finished: false,\r\n      page: 1,\r\n      perPage: 20 // 每页pageNum\r\n    }\r\n  },\r\n  methods: {\r\n    async onLoad () {\r\n      try {\r\n        const { data: res } = await getSearchResultAPI({\r\n          page: this.page,\r\n          per_page: this.perPage,\r\n          q: this.keyword\r\n        })\r\n        this.list.push(...res.data.results)\r\n        // 关闭加载状态\r\n        this.loading = false\r\n        // 判断数据是否完成加载完毕\r\n        if (res.data.results.length) {\r\n          this.page++\r\n        } else {\r\n          // 列表长度为0\r\n          this.finished = true\r\n        }\r\n      } catch (e) {\r\n        this.error = true // 展示加载失败的提示状态\r\n        this.loading = false // 加载失败了 loading 也要关闭\r\n        // this.$toast('数据加载失败，请稍后再试')\r\n        console.log(e.response.data.message)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SearchResult.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SearchResult.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SearchResult.vue?vue&type=template&id=62d01c9c&scoped=true&\"\nimport script from \"./SearchResult.vue?vue&type=script&lang=js&\"\nexport * from \"./SearchResult.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"62d01c9c\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-history\"},[_c('van-cell',{attrs:{\"title\":\"搜索历史\"}},[(_vm.isDeleteShow)?[_c('span',{on:{\"click\":_vm.clearAllSearchHistory}},[_vm._v(\"全部删除\")]),_vm._v(\"    \"),_c('span',{on:{\"click\":function($event){_vm.isDeleteShow = false}}},[_vm._v(\"完成\")])]:_c('van-icon',{attrs:{\"name\":\"delete\"},on:{\"click\":function($event){_vm.isDeleteShow = true}}})],2),_vm._l((_vm.searchHistoriesClone),function(item,index){return _c('van-cell',{key:index,attrs:{\"title\":item},on:{\"click\":function($event){return _vm.onHistoryClick(item, index)}}},[(_vm.isDeleteShow)?_c('van-icon',{attrs:{\"name\":\"close\"}}):_vm._e()],1)})],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"search-history\">\r\n    <van-cell title=\"搜索历史\">\r\n      <template v-if=\"isDeleteShow\">\r\n        <span @click=\"clearAllSearchHistory\">全部删除</span> &nbsp;&nbsp;\r\n        <span @click=\"isDeleteShow = false\">完成</span>\r\n      </template>\r\n      <van-icon v-else name=\"delete\" @click=\"isDeleteShow = true\" />\r\n    </van-cell>\r\n    <van-cell :title=\"item\" v-for=\"(item, index) in searchHistoriesClone\" :key=\"index\"\r\n      @click=\"onHistoryClick(item, index)\">\r\n      <van-icon v-if=\"isDeleteShow\" name=\"close\"></van-icon>\r\n    </van-cell>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n  name: 'SearchHistory',\r\n  props: {\r\n    searchHistory: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      // 不能直接操作父组件数据，克隆一份\r\n      searchHistoriesClone: this.searchHistory,\r\n      isDeleteShow: false // 在 data 中添加一个数据用来控制删除相关元素的显示状态\r\n    }\r\n  },\r\n  methods: {\r\n    onHistoryClick (item, index) {\r\n      if (this.isDeleteShow) {\r\n        // this.searchHistory.splice(index, 1)\r\n        // 删除状态，删除历史记录数据\r\n        // this.searchHistoriesClone.splice(index, 1)\r\n        this.$emit('delSearchHistoryItem', index)\r\n      } else {\r\n        // 非删除状态，直接进入搜索\r\n        this.$emit('search', item)\r\n      }\r\n    },\r\n    clearAllSearchHistory () {\r\n      // 调用父组件方法让历史列表清空\r\n      this.$emit('clearAllSearchHistory')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SearchHistory.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SearchHistory.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SearchHistory.vue?vue&type=template&id=78e3ddaa&scoped=true&\"\nimport script from \"./SearchHistory.vue?vue&type=script&lang=js&\"\nexport * from \"./SearchHistory.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"78e3ddaa\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"search-container\">\r\n    <form action=\"/\">\r\n      <van-search v-model=\"keyword\" placeholder=\"请输入搜索关键词\" background=\"#3296FA\" show-action @search=\"onSearch\"\r\n        @cancel=\"onCancel\" @focus=\"isResultShow = false\" />\r\n    </form>\r\n    <SearchResult v-if=\"isResultShow\" :keyword=\"keyword\"></SearchResult>\r\n    <SearchSuggestion v-else-if=\"keyword\" :keyword=\"keyword\" @search=\"onSearch\"></SearchSuggestion>\r\n    <SearchHistory v-else :searchHistory=\"searchHistory\" @search=\"onSearch\" @delSearchHistoryItem=\"delSearchHistoryItem\"\r\n      @clearAllSearchHistory=\"searchHistory = []\">\r\n    </SearchHistory>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport SearchSuggestion from '@/components/Search/SearchSuggestion.vue'\r\nimport SearchResult from '@/components/Search/SearchResult.vue'\r\nimport SearchHistory from '@/components/Search/SearchHistory.vue'\r\nimport { setItem, getItem } from '@/utils/storage'\r\nexport default {\r\n  name: 'SearchPage',\r\n  components: {\r\n    SearchSuggestion,\r\n    SearchResult,\r\n    SearchHistory\r\n  },\r\n  data () {\r\n    return {\r\n      keyword: '',\r\n      isResultShow: false, // 控制搜索结果的展示\r\n      // searchHistory: [] // 搜索的历史记录数据\r\n      searchHistory: getItem('TOUTIAO_SEARCH_HISTORIES') || [] // 搜索的历史记录数据\r\n    }\r\n  },\r\n  watch: {\r\n    searchHistory (value) {\r\n      setItem('TOUTIAO_SEARCH_HISTORIES', value)\r\n    }\r\n  },\r\n  methods: {\r\n    onSearch (value) {\r\n      this.isResultShow = true // 显示搜索结果\r\n      this.keyword = value\r\n      // 在触发搜索的时候，记录历史记录\r\n      // 要求：不要有重复历史记录、最新的排在最前面\r\n      const index = this.searchHistory.indexOf(value)\r\n      if (index !== -1) {\r\n        this.searchHistory.splice(index, 1)\r\n      }\r\n      this.searchHistory.unshift(value)\r\n    },\r\n    onCancel () {\r\n      this.$toast('取消搜索')\r\n      this.$router.back() // 关闭并返回前一个页面\r\n    },\r\n    delSearchHistoryItem (index) {\r\n      this.searchHistory.splice(index, 1)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.search-container {\r\n  padding-top: 108px;\r\n\r\n  .van-search__action {\r\n    color: #fff;\r\n  }\r\n\r\n  .van-search {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    z-index: 1;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=0c01c8a2&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=0c01c8a2&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0c01c8a2\",\n  null\n  \n)\n\nexport default component.exports","import request from '../utils/request'\r\n\r\n/**\r\n * 获取用户自己的信息\r\n */\r\n//  export const getUserInfo = () => {\r\n//   return request({\r\n//     method: 'GET',\r\n//     url: '/v1_0/user',\r\n//     // 发送请求头数据\r\n//     headers: {\r\n//       // 注意：该接口需要授权才能访问\r\n//       //       token的数据格式：Bearer token数据，注意 Bearer 后面有个空格\r\n//       Authorization: `Bearer ${store.state.user.token}`\r\n//     }\r\n//   })\r\n// }\r\n\r\n/**\r\n * 获取用户自己的信息\r\n * token数据由请求拦截器完成\r\n */\r\nexport const getUserInfo = () => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/user'\r\n  })\r\n}\r\n\r\n/**\r\n * 获取当前登录用户的个人资料\r\n */\r\n export const getUserProfile = target => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/user/profile'\r\n  })\r\n}\r\n\r\n/**\r\n * 更新用户资料\r\n */\r\n export const updateUserProfile = data => {\r\n  return request({\r\n    method: 'PATCH',\r\n    url: '/v1_0/user/profile',\r\n    data\r\n  })\r\n}\r\n/**\r\n * 更新用户照片资料\r\n */\r\n export const updateUserPhoto = data => {\r\n  return request({\r\n    method: 'PATCH',\r\n    url: '/v1_0/user/photo',\r\n    data\r\n  })\r\n}\r\n","import request from '../utils/request'\r\n/**\r\n * 获取文章列表\r\n */\r\n export const getArticles = params => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/articles',\r\n    params\r\n  })\r\n}\r\n\r\n/**\r\n * 获取文章\r\n */\r\n export const getArticleById = articleId => {\r\n  return request({\r\n    method: 'GET',\r\n    url: `/v1_0/articles/${articleId}`\r\n  })\r\n}\r\n\r\n/**\r\n * 关注用户\r\n */\r\n export const addFollow = target => {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/v1_0/user/followings',\r\n    data: {\r\n      target\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * 取消关注用户\r\n */\r\nexport const deleteFollow = target => {\r\n  return request({\r\n    method: 'DELETE',\r\n    url: `/v1_0/user/followings/${target}`\r\n  })\r\n}\r\n\r\n/**\r\n * 收藏文章\r\n */\r\n export const addCollect = target => {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/v1_0/article/collections',\r\n    data: {\r\n      target\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * 取消收藏文章\r\n */\r\nexport const deleteCollect = target => {\r\n  return request({\r\n    method: 'DELETE',\r\n    url: `/v1_0/article/collections/${target}`\r\n  })\r\n}\r\n\r\n/**\r\n * 点赞文章\r\n */\r\n export const addLike = target => {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/v1_0/article/likings',\r\n    data: {\r\n      target\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * 取消点赞文章\r\n */\r\nexport const deleteLike = target => {\r\n  return request({\r\n    method: 'DELETE',\r\n    url: `/v1_0/article/likings/${target}`\r\n  })\r\n}\r\n\r\n/**\r\n * 获取文章评论列表\r\n */\r\n export const getComments = params => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/comments',\r\n    params\r\n  })\r\n}\r\n","import request from '../utils/request'\r\n\r\n/**\r\n * 获取用户频道列表\r\n */\r\n export const getUserChannels = () => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/user/channels'\r\n  })\r\n}\r\n/**\r\n * 获取所有频道列表\r\n */\r\n export const getAllChannel = params => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/channels',\r\n    params\r\n  })\r\n}\r\n\r\n/**\r\n * 添加用户频道\r\n */\r\n export const addUserChannel = channel => {\r\n  return request({\r\n    method: 'PATCH',\r\n    url: '/v1_0/user/channels',\r\n    data: {\r\n      channels: [channel]\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * 删除用户指定频道\r\n */\r\n export const deleteUserChannel = channelId => {\r\n  return request({\r\n    method: 'DELETE',\r\n    url: `/v1_0/user/channels/${channelId}`\r\n  })\r\n}\r\n","import request from '../utils/request'\r\n// 搜索联想词接口\r\nexport const getSearchSuggestions = query => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/suggestion',\r\n    params: {\r\n      q: query\r\n    }\r\n  })\r\n}\r\n// 搜索结果接口\r\nexport const getSearchResult = params => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/search',\r\n    params\r\n  })\r\n}\r\n","import request from '@/utils/request'\r\n/**\r\n * 获取文章评论列表\r\n */\r\n export const getComments = params => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/comments',\r\n    params\r\n  })\r\n}\r\n/**\r\n * 评论点赞\r\n */\r\n export const addCommentLike = target => {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/v1_0/comment/likings',\r\n    data: {\r\n      target\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * 取消评论点赞\r\n */\r\nexport const deleteCommentLike = target => {\r\n  return request({\r\n    method: 'DELETE',\r\n    url: `/v1_0/comment/likings/${target}`\r\n  })\r\n}\r\n\r\n/**\r\n * 发布文章评论或评论回复\r\n * target 评论的目标id（评论文章即为文章id，对评论进行回复则为评论id）\r\n * content 评论内容\r\n * art_id 文章id，对评论内容发表回复时，需要传递此参数，表明所属文章id。对文章进行评论，不要传此参数。\r\n */\r\n export const addComment = data => {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/v1_0/comments',\r\n    data\r\n  })\r\n}\r\n","import { login } from './login'\r\nimport { getUserInfo, getUserProfile, updateUserProfile, updateUserPhoto } from './user'\r\nimport { getArticles, getArticleById, addFollow, deleteFollow, addCollect, deleteCollect, addLike, deleteLike } from './article'\r\nimport { getUserChannels, getAllChannel, addUserChannel, deleteUserChannel } from './channel'\r\nimport { getSearchSuggestions, getSearchResult } from './home'\r\nimport { getComments, addCommentLike, deleteCommentLike, addComment } from './comment'\r\n// 作为公共出口导出接口\r\nexport const loginAPI = login\r\nexport const getUserInfoAPI = getUserInfo\r\nexport const getUserChannelsAPI = getUserChannels\r\nexport const getArticlesAPI = getArticles\r\nexport const getArticleByIdAPI = getArticleById\r\nexport const getAllChannelAPI = getAllChannel\r\nexport const addUserChannelAPI = addUserChannel\r\nexport const deleteUserChannelAPI = deleteUserChannel\r\nexport const getSearchSuggestionsAPI = getSearchSuggestions\r\nexport const getSearchResultAPI = getSearchResult\r\nexport const addFollowAPI = addFollow\r\nexport const deleteFollowAPI = deleteFollow\r\nexport const addCollectAPI = addCollect\r\nexport const deleteCollectAPI = deleteCollect\r\nexport const addLikeAPI = addLike\r\nexport const deleteLikeAPI = deleteLike\r\nexport const getCommentsAPI = getComments\r\nexport const addCommentLikeAPI = addCommentLike\r\nexport const deleteCommentLikeAPI = deleteCommentLike\r\nexport const addCommentAPI = addComment\r\nexport const getUserProfileAPI = getUserProfile\r\nexport const updateUserProfileAPI = updateUserProfile\r\nexport const updateUserPhotoAPI = updateUserPhoto\r\n"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","onSearch","onCancel","$event","isResultShow","model","value","keyword","callback","$$v","expression","searchHistory","delSearchHistoryItem","staticRenderFns","_l","suggestions","item","index","key","$emit","scopedSlots","_u","fn","domProps","_s","highlight","proxy","name","props","type","default","watch","handler","immediate","data","methods","component","finished","error","onLoad","loading","list","art_id","title","page","perPage","per_page","q","console","isDeleteShow","clearAllSearchHistory","_v","searchHistoriesClone","onHistoryClick","_e","components","SearchSuggestion","SearchResult","SearchHistory","setItem","getUserInfo","request","method","url","getUserProfile","target","updateUserProfile","updateUserPhoto","getArticles","params","getArticleById","articleId","addFollow","deleteFollow","addCollect","deleteCollect","addLike","deleteLike","getUserChannels","getAllChannel","addUserChannel","channel","channels","deleteUserChannel","channelId","getSearchSuggestions","query","getSearchResult","getComments","addCommentLike","deleteCommentLike","addComment","getUserInfoAPI","getUserChannelsAPI","getArticlesAPI","getArticleByIdAPI","getAllChannelAPI","addUserChannelAPI","deleteUserChannelAPI","getSearchSuggestionsAPI","getSearchResultAPI","addFollowAPI","deleteFollowAPI","addCollectAPI","deleteCollectAPI","addLikeAPI","deleteLikeAPI","getCommentsAPI","addCommentLikeAPI","deleteCommentLikeAPI","addCommentAPI","getUserProfileAPI","updateUserProfileAPI","updateUserPhotoAPI"],"sourceRoot":""}